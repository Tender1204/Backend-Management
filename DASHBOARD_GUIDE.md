# 控制台模块使用指南

## 功能概述

控制台模块是登录后的首屏页面，提供数据看板功能，包括：
- 6个核心指标卡片（2行3列布局）
- 活跃度趋势折线图
- 功能使用率饼图
- 周期切换（今日/本周/本月）
- 数据刷新
- 图表下载

## 页面结构

### 1. 顶部操作栏

- **左侧**: 页面标题"数据看板"
- **右侧**: 
  - 周期选择器（今日/本周/本月）
  - 刷新按钮

### 2. 核心指标卡片区（2行3列）

6个指标卡片：
1. **总用户数** - 显示总用户数和周期内新增数
2. **活跃用户数** - 显示周期内活跃用户数
3. **提醒触发率** - 显示规则执行完成率
4. **AI问答次数** - 显示周期内AI问答次数
5. **知识库内容数** - 显示知识库总内容数
6. **系统运行状态** - 显示系统运行状态（正常/异常）

**交互**：
- 卡片悬停有阴影提升效果
- 点击卡片跳转到对应模块详情页

### 3. 数据趋势图区

**左侧图表**：活跃度趋势折线图
- 显示周期内活跃用户数变化趋势
- 今日：按小时显示
- 本周/本月：按天显示
- 支持下载PNG格式

**右侧图表**：功能使用率饼图
- 显示各功能模块的使用次数占比
- 支持下载PNG格式

## 数据格式说明

### 指标数据格式

```javascript
{
  period: "今日", // 统计周期
  totalUsers: {
    value: 1250,      // 总用户数
    new: 15,          // 新增用户数
    label: "总用户数",
    unit: "人",
    link: "/users/list" // 跳转路由
  },
  // ... 其他指标
}
```

### 趋势图数据格式

```javascript
{
  times: ["2025-11-22 00:00", "2025-11-22 01:00", ...], // 时间点数组
  counts: [120, 135, 150, ...], // 对应活跃用户数
  period: "today"
}
```

### 使用率数据格式

```javascript
{
  data: [
    { name: "用户管理", value: 1250 },
    { name: "健康规则", value: 980 },
    // ...
  ],
  period: "today"
}
```

## 路由跳转

指标卡片点击后跳转的路由：

| 指标 | 跳转路由 | 说明 |
|------|---------|------|
| 总用户数 | `/users/list` | 用户列表页面 |
| 活跃用户数 | `/users/list?filter=active` | 用户列表（筛选活跃） |
| 提醒触发率 | `/rules/list` | 规则列表页面 |
| AI问答次数 | `/ai/logs` | AI问答日志页面 |
| 知识库内容数 | `/ai/knowledge` | AI知识库管理页面 |
| 系统运行状态 | `/system/logs` | 系统日志页面 |

## 使用说明

### 1. 周期切换

点击顶部操作栏的周期选择器（今日/本周/本月），页面会自动刷新数据：
- **今日**：显示今天的数据，趋势图按小时显示
- **本周**：显示本周的数据，趋势图按天显示
- **本月**：显示本月的数据，趋势图按天显示

### 2. 刷新数据

点击"刷新"按钮，重新加载所有数据。

### 3. 图表下载

点击图表右上角的"下载PNG"按钮，将图表下载为PNG图片。

### 4. 卡片跳转

点击任意指标卡片，跳转到对应的模块详情页面。

## 技术实现

### 前端技术栈

- **Vue 3** + **Composition API**
- **Element Plus** - UI组件库
- **ECharts** - 图表库
- **Axios** - HTTP请求

### 关键组件

- `Dashboard.vue` - 主页面组件
- `ECharts.vue` - ECharts图表封装组件
- `api/dashboard.js` - API接口封装

### API调用

```javascript
import { getIndicators, getTrend, getUsage } from '@/api/dashboard'

// 获取指标数据
const indicators = await getIndicators('today')

// 获取趋势数据
const trend = await getTrend('week')

// 获取使用率数据
const usage = await getUsage('month')
```

## 安装依赖

如果还没有安装ECharts，需要先安装：

```bash
cd "Software Project/frontend"
npm install echarts
```

## 注意事项

1. **数据为空处理**：如果数据库中没有数据，接口会返回0或空数组，页面会正常显示
2. **图表加载**：图表使用ECharts渲染，需要等待数据加载完成后显示
3. **响应式布局**：页面支持响应式，小屏幕会自动调整布局
4. **Token验证**：所有接口都需要Token验证，未登录会自动跳转到登录页

