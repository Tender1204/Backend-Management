# åŠŸèƒ½æ¨¡å—ä½¿ç”¨ä¸å¯¹æ¥æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ¦‚è¿°](#ç³»ç»Ÿæ¶æ„æ¦‚è¿°)
2. [åŠŸèƒ½æ¨¡å—è¯¦è§£](#åŠŸèƒ½æ¨¡å—è¯¦è§£)
3. [æ¨¡å—é—´äº¤äº’æœºåˆ¶](#æ¨¡å—é—´äº¤äº’æœºåˆ¶)
4. [å°ç¨‹åºç«¯å¯¹æ¥æ–¹æ¡ˆ](#å°ç¨‹åºç«¯å¯¹æ¥æ–¹æ¡ˆ)
5. [APIæ¥å£è§„èŒƒ](#apiæ¥å£è§„èŒƒ)
6. [æ•°æ®æµè¯´æ˜](#æ•°æ®æµè¯´æ˜)

---

## ç³»ç»Ÿæ¶æ„æ¦‚è¿°

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å°ç¨‹åºç«¯ (å¾®ä¿¡å°ç¨‹åº)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP/HTTPS API
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åå°ç®¡ç†ç³»ç»Ÿ (æœ¬ç³»ç»Ÿ)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   å‰ç«¯ç•Œé¢    â”‚  â”‚   APIç½‘å…³    â”‚  â”‚   ä¸šåŠ¡é€»è¾‘    â”‚   â”‚
â”‚  â”‚  (Vue 3)     â”‚  â”‚  (Express)   â”‚  â”‚ (Controllers)â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              æ•°æ®è®¿é—®å±‚ (Sequelize ORM)              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MySQL æ•°æ®åº“                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

1. **å‰ç«¯å±‚**: Vue 3 + Element Plusï¼Œæä¾›ç®¡ç†ç•Œé¢
2. **APIå±‚**: Express.jsï¼Œæä¾›RESTful APIæ¥å£
3. **ä¸šåŠ¡é€»è¾‘å±‚**: Controllersï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘
4. **æ•°æ®è®¿é—®å±‚**: Sequelize ORMï¼Œæ•°æ®åº“æ“ä½œ
5. **æ•°æ®å­˜å‚¨å±‚**: MySQLæ•°æ®åº“

---

## åŠŸèƒ½æ¨¡å—è¯¦è§£

### 1. è®¤è¯æ¨¡å— (Auth Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: ç®¡ç†ç³»ç»Ÿç®¡ç†å‘˜èº«ä»½è®¤è¯å’Œæˆæƒ
- **æ ¸å¿ƒåŠŸèƒ½**:
  - ç®¡ç†å‘˜ç™»å½•/ç™»å‡º
  - Tokenç”Ÿæˆä¸éªŒè¯
  - å¯†ç ç®¡ç†
  - æƒé™æ§åˆ¶

#### ä½¿ç”¨æ–¹æ³•

**ç™»å½•æ¥å£**
```javascript
POST /api/auth/login
Body: {
  "username": "admin",
  "password": "200124"
}

Response: {
  "code": 200,
  "data": {
    "id": 1,
    "username": "admin",
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**è·å–ç®¡ç†å‘˜ä¿¡æ¯**
```javascript
GET /api/auth/info
Headers: {
  "Authorization": "Bearer <token>"
}
```

**ä¿®æ”¹å¯†ç **
```javascript
POST /api/auth/change-password
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "oldPassword": "200124",
  "newPassword": "newpassword"
}
```

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **è¢«æ‰€æœ‰æ¨¡å—ä¾èµ–**: æ‰€æœ‰éœ€è¦è®¤è¯çš„æ¥å£éƒ½é€šè¿‡æ­¤æ¨¡å—éªŒè¯Token
- **æä¾›**: JWT Tokenï¼Œç”¨äºåç»­APIè¯·æ±‚çš„èº«ä»½éªŒè¯

---

### 2. ç”¨æˆ·ç®¡ç†æ¨¡å— (User Management Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: ç®¡ç†å°ç¨‹åºç«¯çš„ç”¨æˆ·ä¿¡æ¯
- **æ ¸å¿ƒåŠŸèƒ½**:
  - ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢ä¸ç­›é€‰
  - ç”¨æˆ·è¯¦æƒ…æŸ¥çœ‹
  - ç”¨æˆ·æ ‡ç­¾ç®¡ç†
  - ç”¨æˆ·è´¦å·çŠ¶æ€ç®¡ç†ï¼ˆå¯ç”¨/ç¦ç”¨ï¼‰
  - å¯†ç é‡ç½®

#### ä½¿ç”¨æ–¹æ³•

**è·å–ç”¨æˆ·åˆ—è¡¨**
```javascript
GET /api/users/list?page=1&limit=10&status=1&major=å¼ ä¸‰
Headers: {
  "Authorization": "Bearer <token>"
}

Response: {
  "code": 200,
  "data": {
    "list": [...],
    "total": 100,
    "page": 1,
    "limit": 10
  }
}
```

**è·å–ç”¨æˆ·è¯¦æƒ…**
```javascript
GET /api/users/:id
Headers: {
  "Authorization": "Bearer <token>"
}
```

**åˆ›å»ºç”¨æˆ·æ ‡ç­¾**
```javascript
POST /api/users/tags
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "tag_name": "VIPç”¨æˆ·",
  "tag_desc": "é«˜ä»·å€¼ç”¨æˆ·",
  "color": "#FF0000"
}
```

**ä¿®æ”¹ç”¨æˆ·çŠ¶æ€**
```javascript
PUT /api/users/:id/status
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "status": 0  // 0-ç¦ç”¨, 1-å¯ç”¨
}
```

#### æ•°æ®è¡¨å…³ç³»
- `users` - ç”¨æˆ·ä¸»è¡¨
- `user_tags` - ç”¨æˆ·æ ‡ç­¾è¡¨
- `user_tag_mapping` - ç”¨æˆ·æ ‡ç­¾å…³è”è¡¨

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **è¢«ç»Ÿè®¡æ¨¡å—ä½¿ç”¨**: æä¾›ç”¨æˆ·æ•°æ®ç”¨äºç»Ÿè®¡åˆ†æ
- **è¢«å†…å®¹æ¨¡å—ä½¿ç”¨**: ç”¨äºå†…å®¹æ¨é€çš„ç”¨æˆ·ç­›é€‰
- **è¢«è§„åˆ™æ¨¡å—ä½¿ç”¨**: ç”¨äºè§„åˆ™æ¨¡æ¿çš„ç”¨æˆ·åˆ†é…

---

### 3. å†…å®¹ç®¡ç†æ¨¡å— (Content Management Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: ç®¡ç†å°ç¨‹åºç«¯å±•ç¤ºçš„å¥åº·å†…å®¹
- **æ ¸å¿ƒåŠŸèƒ½**:
  - å†…å®¹åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤
  - å†…å®¹åˆ†ç±»ç®¡ç†
  - å†…å®¹æ¨é€ä»»åŠ¡ç®¡ç†
  - å†…å®¹ç»Ÿè®¡åˆ†æ

#### ä½¿ç”¨æ–¹æ³•

**è·å–å†…å®¹åˆ—è¡¨**
```javascript
GET /api/content/list?page=1&limit=10&category_id=1&status=1
Headers: {
  "Authorization": "Bearer <token>"
}
```

**åˆ›å»ºå†…å®¹**
```javascript
POST /api/content
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "title": "å¥åº·é¥®é£ŸæŒ‡å—",
  "content": "å†…å®¹è¯¦æƒ…...",
  "category_id": 1,
  "cover_image": "https://...",
  "status": 1
}
```

**åˆ›å»ºæ¨é€ä»»åŠ¡**
```javascript
POST /api/content/push
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "content_id": 1,
  "push_type": "all",  // all-å…¨éƒ¨ç”¨æˆ·, tag-æ ‡ç­¾ç”¨æˆ·, user-æŒ‡å®šç”¨æˆ·
  "target_tags": [1, 2],  // æ ‡ç­¾IDæ•°ç»„
  "target_users": [100, 101],  // ç”¨æˆ·IDæ•°ç»„
  "push_time": "2024-01-01 10:00:00"
}
```

**è·å–æ¨é€ä»»åŠ¡åˆ—è¡¨**
```javascript
GET /api/content/push/list?page=1&limit=10
Headers: {
  "Authorization": "Bearer <token>"
}
```

#### æ•°æ®è¡¨å…³ç³»
- `contents` - å†…å®¹ä¸»è¡¨
- `content_categories` - å†…å®¹åˆ†ç±»è¡¨
- `content_push_configs` - å†…å®¹æ¨é€é…ç½®è¡¨

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **ä½¿ç”¨ç”¨æˆ·æ¨¡å—**: è·å–æ¨é€ç›®æ ‡ç”¨æˆ·åˆ—è¡¨
- **ä½¿ç”¨æ ‡ç­¾æ¨¡å—**: é€šè¿‡æ ‡ç­¾ç­›é€‰æ¨é€ç”¨æˆ·
- **è¢«ç»Ÿè®¡æ¨¡å—ä½¿ç”¨**: æä¾›å†…å®¹æ•°æ®ç”¨äºç»Ÿè®¡åˆ†æ
- **ä¸å°ç¨‹åºç«¯äº¤äº’**: å°ç¨‹åºç«¯é€šè¿‡APIè·å–å†…å®¹åˆ—è¡¨å’Œè¯¦æƒ…

---

### 4. å¥åº·è§„åˆ™ç®¡ç†æ¨¡å— (Health Rule Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: ç®¡ç†å¥åº·è§„åˆ™é…ç½®å’Œæ¨¡æ¿
- **æ ¸å¿ƒåŠŸèƒ½**:
  - è§„åˆ™ç±»å‹ç®¡ç†
  - è§„åˆ™æ¨¡æ¿åˆ›å»ºä¸ç®¡ç†
  - è§„åˆ™æ¨¡æ¿åˆ†é…ç»™ç”¨æˆ·
  - è§„åˆ™æ•ˆæœç»Ÿè®¡

#### ä½¿ç”¨æ–¹æ³•

**è·å–è§„åˆ™é…ç½®**
```javascript
GET /api/rules/config
Headers: {
  "Authorization": "Bearer <token>"
}
```

**è·å–è§„åˆ™ç±»å‹**
```javascript
GET /api/rules/types
Headers: {
  "Authorization": "Bearer <token>"
}
```

**åˆ›å»ºè§„åˆ™æ¨¡æ¿**
```javascript
POST /api/rules/templates
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "template_name": "æ¯æ—¥é¥®æ°´æé†’",
  "rule_type_id": 1,
  "rule_config": {
    "threshold": 2500,
    "unit": "ml",
    "reminder_time": "09:00"
  }
}
```

**åˆ†é…æ¨¡æ¿ç»™ç”¨æˆ·**
```javascript
POST /api/rules/templates/:id/assign
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "user_ids": [100, 101, 102]
}
```

**è·å–è§„åˆ™ç»Ÿè®¡**
```javascript
GET /api/rules/statistics?start_date=2024-01-01&end_date=2024-12-31
Headers: {
  "Authorization": "Bearer <token>"
}
```

#### æ•°æ®è¡¨å…³ç³»
- `rule_types` - è§„åˆ™ç±»å‹è¡¨
- `rule_templates` - è§„åˆ™æ¨¡æ¿è¡¨
- `user_rule_records` - ç”¨æˆ·è§„åˆ™æ‰§è¡Œè®°å½•è¡¨

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **ä½¿ç”¨ç”¨æˆ·æ¨¡å—**: è·å–ç”¨æˆ·ä¿¡æ¯ç”¨äºè§„åˆ™åˆ†é…
- **è¢«ç»Ÿè®¡æ¨¡å—ä½¿ç”¨**: æä¾›è§„åˆ™æ‰§è¡Œæ•°æ®ç”¨äºåˆ†æ
- **ä¸å°ç¨‹åºç«¯äº¤äº’**: å°ç¨‹åºç«¯è·å–ç”¨æˆ·çš„è§„åˆ™é…ç½®å’Œæ‰§è¡Œè®°å½•

---

### 5. å¥åº·è§„åˆ™å¯¼å…¥æ¨¡å— (Health Rule Import Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: æ‰¹é‡å¯¼å…¥å«å¥å§”å¥åº·æŒ‡æ ‡è§„åˆ™
- **æ ¸å¿ƒåŠŸèƒ½**:
  - Excelæ–‡ä»¶è§£æä¸å¯¼å…¥
  - è§„åˆ™ç‰ˆæœ¬ç®¡ç†
  - è§„åˆ™é˜ˆå€¼ä¿®æ”¹
  - æ“ä½œæ—¥å¿—è®°å½•

#### ä½¿ç”¨æ–¹æ³•

**è·å–å¥åº·è§„åˆ™åˆ—è¡¨**
```javascript
GET /api/health-rule/list?page=1&limit=10&category=é¥®æ°´å¥åº·
Headers: {
  "Authorization": "Bearer <token>"
}
```

**å¯¼å…¥Excelæ–‡ä»¶**
```javascript
POST /api/health-rule/import
Headers: {
  "Authorization": "Bearer <token>",
  "Content-Type": "multipart/form-data"
}
Body: FormData {
  file: <Excelæ–‡ä»¶>
}
```

**ä¸‹è½½Excelæ¨¡æ¿**
```javascript
GET /api/health-rule/template
Headers: {
  "Authorization": "Bearer <token>"
}
Response: Excelæ–‡ä»¶æµ
```

**ä¿®æ”¹è§„åˆ™é˜ˆå€¼**
```javascript
PUT /api/health-rule/update
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "rule_id": 1,
  "threshold_value": 3000,
  "authority_explanation": "æ›´æ–°åçš„è§£é‡Š"
}
```

**è·å–æ“ä½œæ—¥å¿—**
```javascript
GET /api/health-rule/operate-log?page=1&limit=10
Headers: {
  "Authorization": "Bearer <token>"
}
```

#### æ•°æ®è¡¨å…³ç³»
- `health_standards_dict` - å¥åº·æ ‡å‡†å­—å…¸è¡¨
- `ai_health_recognize_rules` - AIå¥åº·è¯†åˆ«è§„åˆ™è¡¨
- `rule_versions` - è§„åˆ™ç‰ˆæœ¬è¡¨
- `health_rule_operate_logs` - æ“ä½œæ—¥å¿—è¡¨

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **ä¸è§„åˆ™æ¨¡å—å…³è”**: å¯¼å…¥çš„è§„åˆ™å¯ä»¥å…³è”åˆ°è§„åˆ™æ¨¡æ¿
- **è¢«AIæ¨¡å—ä½¿ç”¨**: æä¾›å¥åº·è¯†åˆ«è§„åˆ™
- **è¢«ç»Ÿè®¡æ¨¡å—ä½¿ç”¨**: æä¾›è§„åˆ™ä½¿ç”¨æ•°æ®

---

### 6. æ•°æ®ç»Ÿè®¡åˆ†ææ¨¡å— (Statistics Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: æä¾›ç³»ç»Ÿæ•°æ®ç»Ÿè®¡åˆ†æåŠŸèƒ½
- **æ ¸å¿ƒåŠŸèƒ½**:
  - å…¨å±€æŒ‡æ ‡ç»Ÿè®¡
  - ç”¨æˆ·ç»´åº¦åˆ†æ
  - åŠŸèƒ½ä½¿ç”¨åˆ†æ
  - æ•°æ®å¯è§†åŒ–æ”¯æŒ

#### ä½¿ç”¨æ–¹æ³•

**è·å–å…¨å±€æŒ‡æ ‡**
```javascript
GET /api/statistics/global-indicators?start_date=2024-01-01&end_date=2024-12-31
Headers: {
  "Authorization": "Bearer <token>"
}

Response: {
  "code": 200,
  "data": {
    "totalUsers": 1000,
    "activeUsers": 800,
    "newUsers": 50,
    "contentViews": 5000,
    "ruleTriggers": 3000
  }
}
```

**ç”¨æˆ·ç»´åº¦åˆ†æ**
```javascript
GET /api/statistics/user-dimension?dimension=age&start_date=2024-01-01
Headers: {
  "Authorization": "Bearer <token>"
}
```

**åŠŸèƒ½ä½¿ç”¨åˆ†æ**
```javascript
GET /api/statistics/function-usage?start_date=2024-01-01&end_date=2024-12-31
Headers: {
  "Authorization": "Bearer <token>"
}
```

#### æ•°æ®æ¥æº
- **ç”¨æˆ·æ¨¡å—**: ç”¨æˆ·æ³¨å†Œã€æ´»è·ƒæ•°æ®
- **å†…å®¹æ¨¡å—**: å†…å®¹æµè§ˆã€æ¨é€æ•°æ®
- **è§„åˆ™æ¨¡å—**: è§„åˆ™è§¦å‘ã€å®Œæˆæ•°æ®
- **AIæ¨¡å—**: AIé—®ç­”ã€æŠ¥å‘Šç”Ÿæˆæ•°æ®
- **è¡Œä¸ºæ—¥å¿—**: `user_behavior_logs` è¡¨

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **ä¾èµ–æ‰€æœ‰ä¸šåŠ¡æ¨¡å—**: ä»å„æ¨¡å—æ”¶é›†æ•°æ®è¿›è¡Œåˆ†æ
- **è¢«æ§åˆ¶å°æ¨¡å—ä½¿ç”¨**: æä¾›æ•°æ®çœ‹æ¿çš„æ•°æ®æº

---

### 7. æ§åˆ¶å°æ¨¡å— (Dashboard Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: æä¾›ç³»ç»Ÿæ•°æ®çœ‹æ¿ï¼Œå±•ç¤ºæ ¸å¿ƒæŒ‡æ ‡å’Œè¶‹åŠ¿
- **æ ¸å¿ƒåŠŸèƒ½**:
  - æ ¸å¿ƒæŒ‡æ ‡å±•ç¤º
  - è¶‹åŠ¿å›¾è¡¨æ•°æ®
  - åŠŸèƒ½ä½¿ç”¨ç‡ç»Ÿè®¡
  - æ¨é€å®Œæˆç‡ç»Ÿè®¡

#### ä½¿ç”¨æ–¹æ³•

**è·å–æ ¸å¿ƒæŒ‡æ ‡**
```javascript
GET /api/dashboard/indicators?period=today
Headers: {
  "Authorization": "Bearer <token>"
}

Response: {
  "code": 200,
  "data": {
    "period": "ä»Šæ—¥",
    "totalUsers": {
      "value": 1250,
      "new": 15,
      "label": "æ€»ç”¨æˆ·æ•°"
    },
    "activeUsers": {
      "value": 320,
      "label": "æ´»è·ƒç”¨æˆ·æ•°"
    },
    "reminderRate": {
      "value": 85.5,
      "label": "æé†’è§¦å‘ç‡"
    }
  }
}
```

**è·å–è¶‹åŠ¿æ•°æ®**
```javascript
GET /api/dashboard/trend?period=week&type=user
Headers: {
  "Authorization": "Bearer <token>"
}
```

**è·å–åŠŸèƒ½ä½¿ç”¨ç‡**
```javascript
GET /api/dashboard/usage?period=month
Headers: {
  "Authorization": "Bearer <token>"
}
```

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **ä½¿ç”¨ç»Ÿè®¡æ¨¡å—**: è·å–ç»Ÿè®¡æ•°æ®
- **ä½¿ç”¨ç”¨æˆ·æ¨¡å—**: è·å–ç”¨æˆ·æ•°æ®
- **ä½¿ç”¨å†…å®¹æ¨¡å—**: è·å–å†…å®¹æ•°æ®
- **ä½¿ç”¨è§„åˆ™æ¨¡å—**: è·å–è§„åˆ™æ•°æ®

---

### 8. AIæ¨¡å— (AI Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: ç®¡ç†AIç›¸å…³åŠŸèƒ½ï¼ŒåŒ…æ‹¬çŸ¥è¯†åº“ã€é—®ç­”ã€æŠ¥å‘Šç”Ÿæˆ
- **æ ¸å¿ƒåŠŸèƒ½**:
  - çŸ¥è¯†åº“åŒæ­¥ç®¡ç†
  - AIé—®ç­”æ—¥å¿—æŸ¥çœ‹
  - AIæŠ¥å‘Šæ¨¡æ¿é…ç½®
  - AIæŠ¥å‘Šç”Ÿæˆ
  - APIé…ç½®ç®¡ç†

#### ä½¿ç”¨æ–¹æ³•

**åŒæ­¥çŸ¥è¯†åº“**
```javascript
POST /api/ai/sync-knowledge
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "source": "manual",  // manual-æ‰‹åŠ¨, auto-è‡ªåŠ¨
  "knowledge_data": [...]
}
```

**è·å–é—®ç­”æ—¥å¿—**
```javascript
GET /api/ai/qa-log?page=1&limit=10&user_id=100
Headers: {
  "Authorization": "Bearer <token>"
}
```

**é…ç½®æŠ¥å‘Šæ¨¡æ¿**
```javascript
PUT /api/ai/report-template
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "template_content": "æŠ¥å‘Šæ¨¡æ¿å†…å®¹...",
  "template_config": {...}
}
```

**ç”ŸæˆAIæŠ¥å‘Š**
```javascript
POST /api/ai/generate-report
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "user_id": 100,
  "report_type": "health_summary",
  "data_range": {
    "start_date": "2024-01-01",
    "end_date": "2024-12-31"
  }
}
```

**è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨**
```javascript
GET /api/ai/models
Headers: {
  "Authorization": "Bearer <token>"
}
```

**é…ç½®API**
```javascript
POST /api/ai/api-config
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "api_url": "https://api.example.com",
  "api_key": "your-api-key",
  "model": "gpt-4"
}
```

#### æ•°æ®è¡¨å…³ç³»
- `ai_knowledge_base` - AIçŸ¥è¯†åº“è¡¨
- `ai_qa_log` - AIé—®ç­”æ—¥å¿—è¡¨
- `ai_report_templates` - AIæŠ¥å‘Šæ¨¡æ¿è¡¨
- `ai_generated_reports` - AIç”ŸæˆæŠ¥å‘Šè¡¨

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **ä½¿ç”¨ç”¨æˆ·æ¨¡å—**: è·å–ç”¨æˆ·ä¿¡æ¯ç”¨äºæŠ¥å‘Šç”Ÿæˆ
- **ä½¿ç”¨è§„åˆ™æ¨¡å—**: ä½¿ç”¨å¥åº·è§„åˆ™è¿›è¡ŒAIåˆ†æ
- **è¢«ç»Ÿè®¡æ¨¡å—ä½¿ç”¨**: æä¾›AIä½¿ç”¨æ•°æ®

---

### 9. ç³»ç»Ÿç®¡ç†æ¨¡å— (System Management Module)

#### åŠŸèƒ½è¯´æ˜
- **ä½œç”¨**: ç®¡ç†ç³»ç»Ÿé…ç½®ã€æ—¥å¿—ã€å¤‡ä»½
- **æ ¸å¿ƒåŠŸèƒ½**:
  - ç³»ç»Ÿé…ç½®ç®¡ç†
  - ç³»ç»Ÿæ—¥å¿—æŸ¥çœ‹
  - æ•°æ®å¤‡ä»½ä¸æ¢å¤

#### ä½¿ç”¨æ–¹æ³•

**è·å–ç³»ç»Ÿé…ç½®åˆ—è¡¨**
```javascript
GET /api/system/configs?page=1&limit=10
Headers: {
  "Authorization": "Bearer <token>"
}
```

**ä¿å­˜ç³»ç»Ÿé…ç½®**
```javascript
POST /api/system/configs
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "config_key": "system_name",
  "config_value": "æ™ºæ…§å¥åº·å°ç¨‹åº",
  "config_desc": "ç³»ç»Ÿåç§°"
}
```

**è·å–ç³»ç»Ÿæ—¥å¿—**
```javascript
GET /api/system/logs?page=1&limit=10&level=error&start_date=2024-01-01
Headers: {
  "Authorization": "Bearer <token>"
}
```

**åˆ›å»ºæ•°æ®å¤‡ä»½**
```javascript
POST /api/system/backups
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "backup_name": "2024-01-01å¤‡ä»½",
  "backup_type": "full"  // full-å…¨é‡, incremental-å¢é‡
}
```

#### æ•°æ®è¡¨å…³ç³»
- `system_configs` - ç³»ç»Ÿé…ç½®è¡¨
- `system_logs` - ç³»ç»Ÿæ—¥å¿—è¡¨
- `data_backups` - æ•°æ®å¤‡ä»½è¡¨

#### ä¸å…¶ä»–æ¨¡å—çš„å…³ç³»
- **è¢«æ‰€æœ‰æ¨¡å—ä½¿ç”¨**: æä¾›ç³»ç»Ÿé…ç½®ä¿¡æ¯
- **è®°å½•æ‰€æœ‰æ¨¡å—**: è®°å½•ç³»ç»Ÿæ“ä½œæ—¥å¿—

---

## æ¨¡å—é—´äº¤äº’æœºåˆ¶

### 1. è®¤è¯æœºåˆ¶

æ‰€æœ‰éœ€è¦è®¤è¯çš„æ¥å£éƒ½é€šè¿‡JWT Tokenè¿›è¡ŒéªŒè¯ï¼š

```javascript
// è¯·æ±‚æµç¨‹
1. å‰ç«¯/å°ç¨‹åº â†’ POST /api/auth/login
2. åç«¯éªŒè¯ç”¨æˆ·åå¯†ç 
3. è¿”å›JWT Token
4. å‰ç«¯/å°ç¨‹åºå­˜å‚¨Token
5. åç»­è¯·æ±‚åœ¨Headerä¸­æºå¸¦: Authorization: Bearer <token>
6. åç«¯middleware/auth.jséªŒè¯Token
7. éªŒè¯é€šè¿‡ï¼Œç»§ç»­å¤„ç†ä¸šåŠ¡é€»è¾‘
```

### 2. æ•°æ®å…±äº«æœºåˆ¶

#### é€šè¿‡æ•°æ®åº“è¡¨å…³è”
```sql
-- ç¤ºä¾‹ï¼šç”¨æˆ·æ ‡ç­¾ä¸ç”¨æˆ·çš„å…³ç³»
users (ç”¨æˆ·è¡¨)
  â†“ (ä¸€å¯¹å¤š)
user_tag_mapping (ç”¨æˆ·æ ‡ç­¾å…³è”è¡¨)
  â†“ (å¤šå¯¹ä¸€)
user_tags (æ ‡ç­¾è¡¨)
```

#### é€šè¿‡APIè°ƒç”¨
```javascript
// å†…å®¹æ¨¡å—è°ƒç”¨ç”¨æˆ·æ¨¡å—è·å–ç”¨æˆ·åˆ—è¡¨
ContentController â†’ UserController.getUserList()
```

### 3. äº‹ä»¶é©±åŠ¨æœºåˆ¶

#### å†…å®¹æ¨é€æµç¨‹
```
1. å†…å®¹æ¨¡å—åˆ›å»ºæ¨é€ä»»åŠ¡
   â†“
2. æ ¹æ®æ¨é€ç±»å‹è·å–ç›®æ ‡ç”¨æˆ·
   - all: è·å–æ‰€æœ‰ç”¨æˆ·
   - tag: é€šè¿‡æ ‡ç­¾è·å–ç”¨æˆ·åˆ—è¡¨
   - user: è·å–æŒ‡å®šç”¨æˆ·
   â†“
3. åˆ›å»ºæ¨é€è®°å½•
   â†“
4. å°ç¨‹åºç«¯è½®è¯¢æˆ–æ¥æ”¶æ¨é€é€šçŸ¥
   â†“
5. è®°å½•æ¨é€ç»“æœåˆ°ç»Ÿè®¡æ¨¡å—
```

#### è§„åˆ™è§¦å‘æµç¨‹
```
1. ç”¨æˆ·æ¨¡å—åˆ†é…è§„åˆ™æ¨¡æ¿ç»™ç”¨æˆ·
   â†“
2. å°ç¨‹åºç«¯è®°å½•ç”¨æˆ·è¡Œä¸ºæ•°æ®
   â†“
3. è§„åˆ™æ¨¡å—æ£€æŸ¥æ˜¯å¦è§¦å‘è§„åˆ™
   â†“
4. è§¦å‘åå‘é€æé†’ç»™å°ç¨‹åºç«¯
   â†“
5. è®°å½•è§¦å‘æ—¥å¿—åˆ°ç»Ÿè®¡æ¨¡å—
```

### 4. æ•°æ®æµå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å°ç¨‹åºç«¯    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. ç”¨æˆ·è¡Œä¸ºæ•°æ®
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ç®¡ç†æ¨¡å—          â”‚
â”‚  - ç”¨æˆ·ä¿¡æ¯å­˜å‚¨         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 2. ç”¨æˆ·æ•°æ®
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è§„åˆ™ç®¡ç†æ¨¡å—          â”‚
â”‚  - æ£€æŸ¥è§„åˆ™è§¦å‘         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 3. è§¦å‘è®°å½•
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å†…å®¹ç®¡ç†æ¨¡å—          â”‚
â”‚  - æ¨é€å†…å®¹ç»™ç”¨æˆ·       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 4. æ¨é€è®°å½•
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç»Ÿè®¡åˆ†ææ¨¡å—          â”‚
â”‚  - æ±‡æ€»æ‰€æœ‰æ•°æ®         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 5. ç»Ÿè®¡æ•°æ®
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ§åˆ¶å°æ¨¡å—            â”‚
â”‚  - å±•ç¤ºæ•°æ®çœ‹æ¿         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å°ç¨‹åºç«¯å¯¹æ¥æ–¹æ¡ˆ

### 1. æ¥å£å¯¹æ¥æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å¾®ä¿¡å°ç¨‹åºç«¯                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ é¡µé¢ç»„ä»¶  â”‚  â”‚ APIå°è£…  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â”‚            â”‚                â”‚
â”‚       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚             â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ HTTPS
              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      åå°ç®¡ç†ç³»ç»Ÿ API                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      Express API Server      â”‚   â”‚
â”‚  â”‚  - è®¤è¯ä¸­é—´ä»¶                â”‚   â”‚
â”‚  â”‚  - ä¸šåŠ¡é€»è¾‘å¤„ç†              â”‚   â”‚
â”‚  â”‚  - æ•°æ®è¿”å›                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å°ç¨‹åºç«¯APIå°è£…ç¤ºä¾‹

#### åˆ›å»ºAPIå·¥å…·ç±»

```javascript
// utils/api.js (å°ç¨‹åºç«¯)
const BASE_URL = 'https://your-domain.com/api'

// è¯·æ±‚å°è£…
function request(url, method, data, needAuth = true) {
  return new Promise((resolve, reject) => {
    const header = {
      'Content-Type': 'application/json'
    }
    
    // å¦‚æœéœ€è¦è®¤è¯ï¼Œæ·»åŠ Token
    if (needAuth) {
      const token = wx.getStorageSync('token')
      if (token) {
        header['Authorization'] = `Bearer ${token}`
      }
    }
    
    wx.request({
      url: BASE_URL + url,
      method: method,
      data: data,
      header: header,
      success: (res) => {
        if (res.statusCode === 200) {
          if (res.data.code === 200) {
            resolve(res.data.data)
          } else if (res.data.code === 401) {
            // Tokenè¿‡æœŸï¼Œé‡æ–°ç™»å½•
            wx.removeStorageSync('token')
            wx.reLaunch({
              url: '/pages/login/login'
            })
            reject(res.data)
          } else {
            wx.showToast({
              title: res.data.message || 'è¯·æ±‚å¤±è´¥',
              icon: 'none'
            })
            reject(res.data)
          }
        } else {
          reject(res)
        }
      },
      fail: (err) => {
        wx.showToast({
          title: 'ç½‘ç»œé”™è¯¯',
          icon: 'none'
        })
        reject(err)
      }
    })
  })
}

// APIæ–¹æ³•å°è£…
const api = {
  // ç”¨æˆ·ç›¸å…³
  login: (code) => request('/auth/login', 'POST', { code }),
  getUserInfo: () => request('/users/info', 'GET'),
  updateUserInfo: (data) => request('/users/info', 'PUT', data),
  
  // å†…å®¹ç›¸å…³
  getContentList: (params) => request('/content/list', 'GET', params),
  getContentDetail: (id) => request(`/content/${id}`, 'GET'),
  
  // è§„åˆ™ç›¸å…³
  getUserRules: () => request('/rules/user-rules', 'GET'),
  recordRuleData: (data) => request('/rules/record', 'POST', data),
  
  // AIç›¸å…³
  aiQa: (question) => request('/ai/qa', 'POST', { question }),
  getHealthReport: () => request('/ai/report', 'GET'),
}

module.exports = api
```

### 3. å°ç¨‹åºç«¯å¯¹æ¥æ¥å£æ¸…å•

#### ç”¨æˆ·ç›¸å…³æ¥å£

```javascript
// 1. ç”¨æˆ·ç™»å½•ï¼ˆå¾®ä¿¡æˆæƒï¼‰
POST /api/users/wx-login
Body: {
  "code": "å¾®ä¿¡æˆæƒcode",
  "userInfo": {
    "nickName": "ç”¨æˆ·æ˜µç§°",
    "avatarUrl": "å¤´åƒURL"
  }
}
Response: {
  "code": 200,
  "data": {
    "user_id": 100,
    "token": "jwt-token",
    "is_new_user": true
  }
}

// 2. è·å–ç”¨æˆ·ä¿¡æ¯
GET /api/users/info
Headers: {
  "Authorization": "Bearer <token>"
}

// 3. æ›´æ–°ç”¨æˆ·ä¿¡æ¯
PUT /api/users/info
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "nickname": "æ–°æ˜µç§°",
  "avatar": "å¤´åƒURL",
  "gender": 1,
  "birthday": "1990-01-01",
  "height": 175.5,
  "weight": 70.0
}

// 4. è®°å½•ç”¨æˆ·è¡Œä¸º
POST /api/users/behavior-log
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "action": "view_content",  // view_content, use_function, etc.
  "target_id": 1,
  "target_type": "content"
}
```

#### å†…å®¹ç›¸å…³æ¥å£

```javascript
// 1. è·å–å†…å®¹åˆ—è¡¨
GET /api/content/list?page=1&limit=10&category_id=1
Headers: {
  "Authorization": "Bearer <token>"
}

// 2. è·å–å†…å®¹è¯¦æƒ…
GET /api/content/:id
Headers: {
  "Authorization": "Bearer <token>"
}

// 3. è®°å½•å†…å®¹æµè§ˆ
POST /api/content/:id/view
Headers: {
  "Authorization": "Bearer <token>"
}
```

#### è§„åˆ™ç›¸å…³æ¥å£

```javascript
// 1. è·å–ç”¨æˆ·çš„è§„åˆ™åˆ—è¡¨
GET /api/rules/user-rules
Headers: {
  "Authorization": "Bearer <token>"
}
Response: {
  "code": 200,
  "data": {
    "rules": [
      {
        "rule_id": 1,
        "rule_name": "æ¯æ—¥é¥®æ°´æé†’",
        "threshold": 2500,
        "unit": "ml",
        "reminder_time": "09:00"
      }
    ]
  }
}

// 2. è®°å½•è§„åˆ™æ•°æ®
POST /api/rules/record
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "rule_id": 1,
  "record_value": 2000,
  "record_time": "2024-01-01 10:00:00"
}

// 3. è·å–è§„åˆ™å®Œæˆæƒ…å†µ
GET /api/rules/completion?rule_id=1&start_date=2024-01-01&end_date=2024-12-31
Headers: {
  "Authorization": "Bearer <token>"
}
```

#### AIç›¸å…³æ¥å£

```javascript
// 1. AIé—®ç­”
POST /api/ai/qa
Headers: {
  "Authorization": "Bearer <token>"
}
Body: {
  "question": "æ¯å¤©åº”è¯¥å–å¤šå°‘æ°´ï¼Ÿ"
}
Response: {
  "code": 200,
  "data": {
    "answer": "æ ¹æ®å›½å®¶å«å¥å§”å»ºè®®...",
    "sources": [...]
  }
}

// 2. è·å–å¥åº·æŠ¥å‘Š
GET /api/ai/report?type=weekly
Headers: {
  "Authorization": "Bearer <token>"
}
```

### 4. å°ç¨‹åºç«¯æ•°æ®åŒæ­¥æµç¨‹

#### ç”¨æˆ·ç™»å½•æµç¨‹

```
1. å°ç¨‹åºç«¯è°ƒç”¨ wx.login() è·å– code
   â†“
2. è°ƒç”¨åå°æ¥å£ POST /api/users/wx-login
   â†“
3. åå°éªŒè¯ codeï¼Œè·å– openid
   â†“
4. æŸ¥è¯¢æˆ–åˆ›å»ºç”¨æˆ·è®°å½•
   â†“
5. è¿”å› user_id å’Œ token
   â†“
6. å°ç¨‹åºç«¯å­˜å‚¨ token
   â†“
7. åç»­è¯·æ±‚æºå¸¦ token
```

#### å†…å®¹è·å–æµç¨‹

```
1. å°ç¨‹åºç«¯è¯·æ±‚ GET /api/content/list
   â†“
2. åå°éªŒè¯ tokenï¼ŒæŸ¥è¯¢å†…å®¹åˆ—è¡¨
   â†“
3. è¿”å›å†…å®¹æ•°æ®
   â†“
4. ç”¨æˆ·æµè§ˆå†…å®¹
   â†“
5. å°ç¨‹åºç«¯è®°å½•æµè§ˆè¡Œä¸º POST /api/content/:id/view
   â†“
6. åå°è®°å½•åˆ° user_behavior_logs è¡¨
```

#### è§„åˆ™æ‰§è¡Œæµç¨‹

```
1. å°ç¨‹åºç«¯è·å–ç”¨æˆ·è§„åˆ™ GET /api/rules/user-rules
   â†“
2. ç”¨æˆ·è®°å½•æ•°æ®ï¼ˆå¦‚é¥®æ°´é‡ï¼‰
   â†“
3. å°ç¨‹åºç«¯æäº¤æ•°æ® POST /api/rules/record
   â†“
4. åå°æ£€æŸ¥æ˜¯å¦è¾¾åˆ°é˜ˆå€¼
   â†“
5. å¦‚æœè¾¾åˆ°ï¼Œè§¦å‘æé†’
   â†“
6. å°ç¨‹åºç«¯æ¥æ”¶æé†’å¹¶å±•ç¤º
   â†“
7. è®°å½•åˆ° user_rule_records è¡¨
```

### 5. å°ç¨‹åºç«¯å¯¹æ¥æ³¨æ„äº‹é¡¹

#### å®‰å…¨è€ƒè™‘

1. **Tokenç®¡ç†**
   - Tokenå­˜å‚¨åœ¨æœ¬åœ°å­˜å‚¨
   - Tokenè¿‡æœŸåè‡ªåŠ¨è·³è½¬ç™»å½•
   - æ•æ„Ÿæ“ä½œéœ€è¦é‡æ–°éªŒè¯

2. **æ•°æ®åŠ å¯†**
   - æ•æ„Ÿæ•°æ®ä¼ è¾“ä½¿ç”¨HTTPS
   - ç”¨æˆ·å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯åŠ å¯†ä¼ è¾“

3. **æ¥å£é™æµ**
   - å°ç¨‹åºç«¯å®ç°è¯·æ±‚é˜²æŠ–
   - åå°å®ç°æ¥å£é™æµæœºåˆ¶

#### æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®ç¼“å­˜**
   ```javascript
   // ç¼“å­˜å†…å®¹åˆ—è¡¨
   const cacheKey = 'content_list'
   const cached = wx.getStorageSync(cacheKey)
   if (cached && Date.now() - cached.timestamp < 300000) {
     // 5åˆ†é’Ÿå†…ä½¿ç”¨ç¼“å­˜
     return cached.data
   }
   ```

2. **åˆ†é¡µåŠ è½½**
   ```javascript
   // ä½¿ç”¨åˆ†é¡µåŠ è½½ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®
   loadMore() {
     this.page++
     api.getContentList({ page: this.page, limit: 10 })
   }
   ```

3. **å›¾ç‰‡ä¼˜åŒ–**
   - ä½¿ç”¨CDNåŠ é€Ÿ
   - å›¾ç‰‡æ‡’åŠ è½½
   - å‹ç¼©å›¾ç‰‡å¤§å°

---

## APIæ¥å£è§„èŒƒ

### ç»Ÿä¸€å“åº”æ ¼å¼

```javascript
// æˆåŠŸå“åº”
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    // å…·ä½“æ•°æ®
  }
}

// é”™è¯¯å“åº”
{
  "code": 400,  // 400-å‚æ•°é”™è¯¯, 401-æœªæˆæƒ, 403-ç¦æ­¢è®¿é—®, 404-æœªæ‰¾åˆ°, 500-æœåŠ¡å™¨é”™è¯¯
  "message": "é”™è¯¯ä¿¡æ¯",
  "error": "è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰"
}
```

### åˆ†é¡µå“åº”æ ¼å¼

```javascript
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [...],
    "total": 100,
    "page": 1,
    "limit": 10,
    "totalPages": 10
  }
}
```

### è®¤è¯Tokenæ ¼å¼

```
Authorization: Bearer <jwt-token>
```

---

## æ•°æ®æµè¯´æ˜

### å®Œæ•´æ•°æ®æµç¤ºä¾‹ï¼šç”¨æˆ·è®°å½•é¥®æ°´æ•°æ®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å°ç¨‹åºç«¯    â”‚
â”‚  ç”¨æˆ·è®°å½•    â”‚
â”‚  é¥®æ°´é‡:2000mlâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ POST /api/rules/record
       â”‚ { rule_id: 1, record_value: 2000 }
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è§„åˆ™ç®¡ç†æ¨¡å— (Controller)         â”‚
â”‚   1. éªŒè¯Token                       â”‚
â”‚   2. éªŒè¯å‚æ•°                       â”‚
â”‚   3. æŸ¥è¯¢è§„åˆ™é…ç½®                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ•°æ®è®¿é—®å±‚ (Sequelize)             â”‚
â”‚   1. æ’å…¥ user_rule_records          â”‚
â”‚   2. æ›´æ–°ç”¨æˆ·ç»Ÿè®¡æ•°æ®                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL æ•°æ®åº“                       â”‚
â”‚   - user_rule_records                â”‚
â”‚   - users                            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è§„åˆ™æ£€æŸ¥é€»è¾‘                       â”‚
â”‚   åˆ¤æ–­: 2000 < 2500 (é˜ˆå€¼)          â”‚
â”‚   ç»“æœ: æœªè¾¾åˆ°ï¼Œä¸è§¦å‘æé†’           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç»Ÿè®¡æ¨¡å—                           â”‚
â”‚   æ›´æ–°è§„åˆ™æ‰§è¡Œç»Ÿè®¡                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å†…å®¹æ¨é€æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åå°ç®¡ç†ç«¯                         â”‚
â”‚   ç®¡ç†å‘˜åˆ›å»ºæ¨é€ä»»åŠ¡                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ POST /api/content/push
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å†…å®¹ç®¡ç†æ¨¡å—                       â”‚
â”‚   1. åˆ›å»ºæ¨é€ä»»åŠ¡                    â”‚
â”‚   2. æ ¹æ®ç±»å‹è·å–ç›®æ ‡ç”¨æˆ·            â”‚
â”‚      - all: æ‰€æœ‰ç”¨æˆ·                â”‚
â”‚      - tag: æ ‡ç­¾ç”¨æˆ·                 â”‚
â”‚      - user: æŒ‡å®šç”¨æˆ·                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ç®¡ç†æ¨¡å—                       â”‚
â”‚   æŸ¥è¯¢ç›®æ ‡ç”¨æˆ·åˆ—è¡¨                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åˆ›å»ºæ¨é€è®°å½•                       â”‚
â”‚   content_push_configs è¡¨            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å°ç¨‹åºç«¯è½®è¯¢                       â”‚
â”‚   GET /api/content/push/notificationsâ”‚
â”‚   è·å–å¾…æ¨é€å†…å®¹                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·æŸ¥çœ‹å†…å®¹                       â”‚
â”‚   è®°å½•æµè§ˆè¡Œä¸º                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å°ç¨‹åºç«¯å¯¹æ¥æ£€æŸ¥æ¸…å•

### æ¥å£å¯¹æ¥
- [ ] ç”¨æˆ·ç™»å½•æ¥å£å·²å¯¹æ¥
- [ ] Tokenå­˜å‚¨å’Œç®¡ç†å·²å®ç°
- [ ] ç”¨æˆ·ä¿¡æ¯è·å–å’Œæ›´æ–°å·²å¯¹æ¥
- [ ] å†…å®¹åˆ—è¡¨å’Œè¯¦æƒ…æ¥å£å·²å¯¹æ¥
- [ ] è§„åˆ™è·å–å’Œè®°å½•æ¥å£å·²å¯¹æ¥
- [ ] AIé—®ç­”æ¥å£å·²å¯¹æ¥
- [ ] è¡Œä¸ºæ—¥å¿—è®°å½•å·²å®ç°

### åŠŸèƒ½å®ç°
- [ ] ç”¨æˆ·ç™»å½•æµç¨‹å®Œæ•´
- [ ] å†…å®¹å±•ç¤ºåŠŸèƒ½æ­£å¸¸
- [ ] è§„åˆ™æé†’åŠŸèƒ½æ­£å¸¸
- [ ] æ•°æ®è®°å½•åŠŸèƒ½æ­£å¸¸
- [ ] AIé—®ç­”åŠŸèƒ½æ­£å¸¸

### æµ‹è¯•éªŒè¯
- [ ] æ‰€æœ‰æ¥å£æµ‹è¯•é€šè¿‡
- [ ] æ•°æ®åŒæ­¥æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚

---

## æ€»ç»“

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†ï¼š

1. âœ… **å„åŠŸèƒ½æ¨¡å—çš„ä½¿ç”¨æ–¹æ³•å’ŒåŠŸèƒ½è¯´æ˜**
2. âœ… **æ¨¡å—é—´çš„äº¤äº’æœºåˆ¶å’Œæ•°æ®æµ**
3. âœ… **å°ç¨‹åºç«¯å¯¹æ¥æ–¹æ¡ˆå’Œæ¥å£è§„èŒƒ**
4. âœ… **å®Œæ•´çš„æ•°æ®æµç¤ºä¾‹**

é€šè¿‡æœ¬æ–‡æ¡£ï¼Œå¼€å‘äººå‘˜å¯ä»¥ï¼š
- ç†è§£ç³»ç»Ÿæ¶æ„å’Œæ¨¡å—å…³ç³»
- æ­£ç¡®ä½¿ç”¨å„ä¸ªåŠŸèƒ½æ¨¡å—
- å®ç°å°ç¨‹åºç«¯ä¸åå°çš„å¯¹æ¥
- ç†è§£æ•°æ®åœ¨ç³»ç»Ÿä¸­çš„æµè½¬è¿‡ç¨‹

---

**å¦‚æœ‰ç–‘é—®ï¼Œè¯·å‚è€ƒé¡¹ç›®äº¤æ¥æ–‡æ¡£æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚**

*æœ€åæ›´æ–°: 2025-11-24*

